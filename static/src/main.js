import Vue from 'vue'
import VueX from 'vuex'
import VueRouter from 'vue-router'
import VueResource from 'vue-resource';
import App from './App.vue'
import * as VueGoogleMaps from 'vue2-google-maps'

import Autogenerated from './pages/Autogenerated.vue';
import CrowdstartedResults from './pages/CrowdstartedResults.vue';
import RunningResults from './pages/RunningResults.vue';
import NewCrowdstart from './pages/NewCrowdstart.vue';
import SearchForm from './pages/SearchForm.vue';
import mapBus from './utils/mapBus';
import {createStore} from './store';

require('bootstrap/dist/css/bootstrap.css')

Vue.use(VueResource);
Vue.use(VueRouter);
Vue.use(VueX);
Vue.use(VueGoogleMaps, {
  load: {
    client: 'gme-infocommunications',
    libraries: 'places,geometry',
  }
});

const router = new VueRouter({
  routes: [
    {
      path: '/search', component: SearchForm
    },
    {
      path: '/', redirect: '/search'
    },
    {
      path: '/crowdstarted', component: CrowdstartedResults
    },
    {
      path: '/autogenerated', component: Autogenerated
    },
    {
      path: '/new', component: NewCrowdstart
    },
    {
      path: '/running', component: RunningResults
    },
  ]
})

new Vue({
  el: '#app',
  template: `<App/>`,
  components: { App },
  router,
  store: createStore(),
  watch: {
    '$route'() {
      this.$nextTick(() => mapBus.$emit('resize'))
    }
  }
})
